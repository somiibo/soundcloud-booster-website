"use strict";(self.webpackChunkultimate_jekyll=self.webpackChunkultimate_jekyll||[]).push([[2717],{2717:(e,t,o)=>{o.d(t,{A:()=>n});var s=o(2984);function n(e){const{webManager:t}=e;let n=null;const r={allowMultipleSubmissions:!1,validateOnSubmit:!0},a="true"===new URL(window.location.href).searchParams.get("authPopup")||window!==window.top;async function i(e,t){const{getAuth:s,signInWithEmailAndPassword:n}=await Promise.all([o.e(9943),o.e(7480)]).then(o.bind(o,7480)),r=s();return await n(r,e,t)}async function c(e,s="signin"){try{const{getAuth:r,signInWithPopup:i,signInWithRedirect:c,GoogleAuthProvider:u,FacebookAuthProvider:h,TwitterAuthProvider:w,GithubAuthProvider:m}=await Promise.all([o.e(9943),o.e(7480)]).then(o.bind(o,7480)),g=r();let p;switch(e){case"google.com":p=new u;break;case"facebook.com":p=new h;break;case"twitter.com":p=new w;break;case"github.com":p=new m;break;default:throw new Error(`Unsupported provider: ${e}`)}if(t.isDevelopment()&&!a&&(t.utilities().showNotification("OAuth redirect may fail in development. Use localhost:4000 or add ?authPopup=true to the URL",{type:"warning",timeout:1e4}),await new Promise(e=>setTimeout(e,1e3))),a)try{const t=await i(g,p);console.log("Successfully authenticated via popup:",t.user.email);const o=t.additionalUserInfo?.isNewUser;o||"signup"===s?(l(e,t.user),n.showSuccess("Account created successfully!")):(d(e,t.user),n.showSuccess("Successfully signed in!")),n.setFormState("submitted")}catch(e){if("auth/popup-blocked"!==e.code&&"auth/popup-closed-by-user"!==e.code&&"auth/cancelled-popup-request"!==e.code)throw e;console.log("Popup failed, falling back to redirect:",e.code),await c(g,p)}else console.log("Using redirect for authentication"),await c(g,p)}catch(e){if(u(e.code)||t.sentry().captureException(new Error("OAuth provider sign-in error",{cause:e})),"auth/account-exists-with-different-credential"===e.code)throw new Error("An account already exists with the same email address but different sign-in credentials. Try signing in with a different provider.");if("auth/invalid-credential"===e.code)throw new Error("Invalid credentials. Please try again.");if("auth/operation-not-allowed"===e.code)throw new Error("This sign-in method is not enabled. Please contact support.");if("auth/user-disabled"===e.code)throw new Error("This account has been disabled. Please contact support.");throw e}}function u(e){return["auth/user-not-found","auth/wrong-password","auth/invalid-credential","auth/invalid-email","auth/weak-password","auth/email-already-in-use","auth/user-disabled","auth/too-many-requests","auth/popup-closed-by-user","auth/cancelled-popup-request"].includes(e)}function d(e,t){const o=t.uid;gtag("event","login",{method:e,user_id:o}),fbq("trackCustom","Login",{method:e,status:"success"}),ttq.track("Login",{content_name:"Account",content_id:o,status:"success"})}function l(e,t){const o=t.uid;gtag("event","sign_up",{method:e,user_id:o}),fbq("track","CompleteRegistration",{content_name:"Account",status:"success",value:0,currency:"USD"}),ttq.track("CompleteRegistration",{content_name:"Account",content_id:o,status:"success"})}function h(){gtag("event","password_reset",{method:"email",status:"success"}),fbq("trackCustom","PasswordReset",{method:"email",status:"success"}),ttq.track("SubmitForm",{content_name:"Password Reset",content_type:"account_recovery"})}t.dom().ready().then(async()=>{await async function(e){const t=new URL(window.location.href);if("true"===t.searchParams.get("authSignout"))try{console.log("Signing out user due to authSignout=true parameter"),await e.auth().signOut(),t.searchParams.delete("authSignout"),window.history.replaceState({},document.title,t.toString())}catch(e){console.error("Error signing out:",e)}}(t),function(){const e=document.documentElement.getAttribute("data-page-path");e?"/signin"===e?(n=new s.A("#signin-form",{...r,submitButtonLoadingText:"Signing in..."}),n.addEventListener("submit",async e=>{e.preventDefault();const{submitButton:t,data:o}=e.detail,s=t?.getAttribute("data-provider");if("email"===s){const e=n.validate(o);if(!e.isValid)return n.showErrors(e.errors),void n.setFormState("ready")}try{"email"===s?await async function(e){const t=e.email?.trim()||"",o=e.password||"";console.log("Attempting email sign-in for:",t),d("email",(await i(t,o)).user),n.showSuccess("Successfully signed in!"),n.setFormState("submitted")}(o):s&&await c(s,"signin")}catch(e){n.setFormState("ready"),n.showError(e.message||"An error occurred during sign in"),console.error("Signin error:",e)}})):"/signup"===e?(n=new s.A("#signup-form",{...r,submitButtonLoadingText:"Creating account..."}),n.addEventListener("submit",async e=>{e.preventDefault();const{submitButton:t,data:s}=e.detail,r=t?.getAttribute("data-provider");if("email"===r){const e=n.validate(s);if(!e.isValid)return n.showErrors(e.errors),void n.setFormState("ready")}try{"email"===r?await async function(e){const t=e.email?.trim()||"",s=e.password||"",{getAuth:r,createUserWithEmailAndPassword:a}=await Promise.all([o.e(9943),o.e(7480)]).then(o.bind(o,7480)),c=r();try{l("email",(await a(c,t,s)).user),n.showSuccess("Account created successfully!"),n.setFormState("submitted")}catch(e){if("auth/email-already-in-use"===e.code)try{return console.log("Email already in use, attempting to sign in instead:",t),d("email",(await i(t,s)).user),n.showSuccess("Successfully signed in!"),void n.setFormState("submitted")}catch(e){throw new Error("An account with this email already exists")}throw e}}(s):r&&await c(r,"signup")}catch(e){n.setFormState("ready"),n.showError(e.message||"An error occurred during sign up"),console.error("Signup error:",e)}})):"/reset"===e&&(n=new s.A("#reset-form",{...r,submitButtonLoadingText:"Sending...",submitButtonSuccessText:"Email Sent!"}),n.addEventListener("submit",async e=>{e.preventDefault();const{data:t}=e.detail;try{await async function(e){const t=e.email?.trim()||"",{getAuth:s,sendPasswordResetEmail:r}=await Promise.all([o.e(9943),o.e(7480)]).then(o.bind(o,7480)),a=s();try{await r(a,t),h(),n.showSuccess(`Password reset email sent to ${t}. Please check your inbox.`),n.setFormState("submitted")}catch(e){if("auth/user-not-found"===e.code)return h(),n.showSuccess(`If an account exists for ${t}, a password reset email has been sent.`),void n.setFormState("submitted");throw e}}(t)}catch(e){n.setFormState("ready"),n.showError(e.message||"An error occurred during password reset"),console.error("Reset error:",e)}})):console.warn("No data-page-path attribute found on HTML element")}(),await async function(){try{const{getAuth:e,getRedirectResult:t}=await Promise.all([o.e(9943),o.e(7480)]).then(o.bind(o,7480)),s=e(),r=await t(s);if(console.log("Redirect result:",r),!r||!r.user)return;console.log("Successfully authenticated via redirect:",r.user.email);const a=r.providerId||r.user.providerData?.[0]?.providerId||"unknown",i=r.additionalUserInfo?.isNewUser,c=document.documentElement.getAttribute("data-page-path");i||"/signup"===c?(l(a,r.user),n.showSuccess("Account created successfully!"),n.setFormState("submitted")):(d(a,r.user),n.showSuccess("Successfully signed in!"),n.setFormState("submitted"))}catch(e){u(e.code)||t.sentry().captureException(new Error("Error handling redirect result",{cause:e})),"auth/account-exists-with-different-credential"===e.code?n.showError("An account already exists with the same email address but different sign-in credentials. Try signing in with a different provider."):"auth/popup-blocked"===e.code?n.showError("Popup was blocked. Please allow popups for this site and try again."):"auth/operation-not-allowed"===e.code?n.showError("This sign-in method is not enabled."):e.code&&"auth/cancelled-popup-request"!==e.code&&n.showError(`Authentication error: ${e.message}`)}}(),function(){const e=t.config.auth?.config?.allowSubdomainAuth??!0,o=window.location.hostname,s=o.split("."),n=s.length>=3&&!o.includes("localhost")&&!/^\d+\.\d+\.\d+\.\d+$/.test(o);if(console.log("checkSubdomainAuth - hostname:",o,"parts:",s,"isSubdomain:",n,"allowSubdomainAuth:",e),e)return!1;if(!n)return!1;const r=s.slice(-2).join("."),a=new URL(window.location.href);return a.hostname=r,console.log("Redirecting to apex domain for authentication:",a.href),window.location.href=a.href,!0}()||(function(){const e=new URL(window.location.href).searchParams.get("authReturnUrl");e?document.querySelectorAll("a[href]").forEach(t=>{if(!t.href.includes("/signin")&&!t.href.includes("/signup")&&!t.href.includes("/reset"))return;const o=new URL(t.href,window.location.origin);o.searchParams.set("authReturnUrl",e),t.href=o.toString()}):console.warn("No authReturnUrl provided in URL parameters.")}(),document.querySelectorAll(".uj-password-toggle").forEach(e=>{e.addEventListener("click",()=>{const t=e.closest(".input-group").querySelector("input");if(!t)return;const o="password"===t.type?"text":"password";t.type=o;const s=e.querySelector(".uj-password-show"),n=e.querySelector(".uj-password-hide");s&&n&&("text"===o?(s.classList.add("d-none"),n.classList.remove("d-none")):(s.classList.remove("d-none"),n.classList.add("d-none")))})}))})}}}]);
(()=>{const t=window.Manager,e=t?.webManager,a=new URLSearchParams(window.location.search),s="true"===a.get("debug"),o="true"===a.get("loud");e.dom().ready().then(()=>{const t=document.currentScript;if(!t)return void console.error("[Vert] Unable to find current script element");const e={client:t.getAttribute("data-ad-client"),slot:t.getAttribute("data-ad-slot"),type:t.getAttribute("data-ad-type")||"display",layout:t.getAttribute("data-ad-layout"),style:t.getAttribute("data-ad-style")||""};console.log("[Vert] Initializing ad unit:",e,t),l(e,t)});const i=(t,a)=>{window.__ujVertMessageHandlerSetup||(window.__ujVertMessageHandlerSetup=!0,window.addEventListener("message",t=>{const e=t.data||{},a=e.command||"",s=e.payload||{};try{!s.id&&t.source.name&&(s.id=t.source.name)}catch(t){console.warn("[Vert] Failed to auto-set id",t)}if(console.log("[Vert] Message received:",a,s),"uj-vert-unit:set-dimensions"===a){const t=document.getElementById(s.id);t&&(t.style.height=s.height+"px")}else"uj-vert-unit:click"===a&&(window.location.href=s.url)},!1));const o=document.createElement("iframe"),i=`vert-${window.__ujVertIdCounter=(window.__ujVertIdCounter||0)+1}`,l=new URL(s?"http://localhost:4001/verts/main":"https://promo-server.itwcreativeworks.com/verts/main");l.searchParams.set("parentURL",window.location.href),l.searchParams.set("frameId",i),o.id=i,o.name=i,o.style.cssText=a.style,o.setAttribute("sandbox","allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation"),o.width="100%",o.height="100%",o.setAttribute("frameborder","0"),o.setAttribute("marginwidth","0"),o.setAttribute("marginheight","0"),o.setAttribute("vspace","0"),o.setAttribute("hspace","0"),o.setAttribute("allowtransparency","true"),o.setAttribute("scrolling","no"),o.src=l.toString(),t.innerHTML="",t.appendChild(o),e.auth().listen({once:!0},async()=>{e.bindings().update()}),console.log("[Vert] Custom ad unit created")},l=(t,a)=>{const s=document.createElement("vert-unit");s.className="uj-vert-unit",s.setAttribute("data-wm-bind","@hide auth.account.subscription.product !== basic");const l=document.createElement("ins");if(l.className="adsbygoogle",l.setAttribute("data-ad-client",t.client),"display"===t.type)l.style.cssText=`display:block; ${t.style}`,l.setAttribute("data-ad-format","auto"),l.setAttribute("data-full-width-responsive","true"),t.slot&&l.setAttribute("data-ad-slot",t.slot);else if("in-article"===t.type)l.style.cssText=`display:block; text-align:center; ${t.style}`,l.setAttribute("data-ad-layout","in-article"),l.setAttribute("data-ad-format","fluid"),t.slot&&l.setAttribute("data-ad-slot",t.slot);else if("in-feed"===t.type){let e=t.layout||"image-above";"image-above"===e?e="-6t+ed+2x-11-88":"image-side"===e&&(e="-fb+5w+4e-db+86"),l.style.cssText=`display:block; ${t.style}`,l.setAttribute("data-ad-format","fluid"),l.setAttribute("data-ad-layout-key",e),t.slot&&l.setAttribute("data-ad-slot",t.slot)}else{if("multiplex"!==t.type)return"custom"===t.type?(a.parentNode.insertBefore(s,a),void i(s,t)):void console.error("[Vert] Unsupported ad type:",t.type);l.style.cssText=`display:block; ${t.style}`,l.setAttribute("data-ad-format","autorelaxed"),t.slot&&l.setAttribute("data-ad-slot",t.slot)}s.appendChild(l),a.parentNode.insertBefore(s,a),(t=>window.adsbygoogle&&Array.isArray(window.adsbygoogle)?Promise.resolve():e.dom().loadScript({src:`https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=${t.client}`,async:!0,crossorigin:"anonymous"}))(t).then(()=>{(window.adsbygoogle=window.adsbygoogle||[]).push({}),((t,e)=>{let a=0;const s=()=>{const l=t.querySelector("ins.adsbygoogle"),r=l?l.getAttribute("data-ad-status"):null;if(o&&console.log("[Vert] Checking ad status...",r),"unfilled"===r)return console.log("[Vert] Adsense is unfilled, loading fallback"),i(t,e);"filled"!==r?a<1e4?(a+=100,setTimeout(s,100)):(console.log("[Vert] Adsense timed out, loading fallback"),i(t,e)):console.log("[Vert] Adsense is filled, no fallback needed")};s()})(s,t),e.auth().listen({once:!0},async()=>{e.bindings().update()}),console.log("[Vert] Ad unit pushed to adsbygoogle")}).catch(e=>{console.error("[Vert] Failed to load AdSense script, loading fallback:",e),i(s,t)})}})();
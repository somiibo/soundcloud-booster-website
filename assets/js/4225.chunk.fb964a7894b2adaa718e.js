(self.webpackChunkultimate_jekyll=self.webpackChunkultimate_jekyll||[]).push([[4225,6002],{192:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>a});var r=o(4289),n=o.n(r);let s=null;const a=(e,t)=>new Promise(async function(t){return s=e.webManager,await s.dom().ready(),async function(){document.getElementById("oauth2-loading"),document.getElementById("oauth2-result");const e=document.getElementById("oauth2-provider");document.getElementById("error-message"),document.getElementById("return-button"),document.getElementById("result-success"),document.getElementById("result-error");try{const o=new URLSearchParams(window.location.search),r=o.get("code"),a=o.get("state"),c=o.get("error"),i=o.get("error_description");if(c)throw new Error(i||c||"OAuth authorization was denied");if(!r)throw new Error("Missing authorization code");if(!a)throw new Error("Missing state parameter");let d;try{d=JSON.parse(decodeURIComponent(a))}catch(e){throw console.error("Failed to parse state:",e),new Error("Invalid state parameter")}if(console.log("OAuth callback state:",d),!d.provider)throw new Error("Missing provider in state");if(!d.authenticationToken)throw new Error("Missing authentication token");if(!d.serverUrl)throw new Error("Missing server URL");const l=(t=d.provider)?t.charAt(0).toUpperCase()+t.slice(1):"";if(e.textContent=l,d.redirectUrl&&!function(e){try{const o=new URL(e),r=new URL(window.location.href);return o.origin===r.origin||(t=o.hostname,["localhost","127.0.0.1",s?.config?.brand?.domain].filter(Boolean).some(e=>t===e||t.endsWith("."+e)))}catch(e){return!1}var t}(d.redirectUrl))throw new Error("Invalid redirect URL");const u={state:"tokenize",provider:d.provider,code:r};o.forEach((e,t)=>{"state"!==t&&"code"!==t&&(u[t]=e)}),console.log("Tokenize payload:",u);const m=await n()(d.serverUrl,{method:"POST",timeout:6e4,response:"json",tries:2,body:{authenticationToken:d.authenticationToken,command:"user:oauth2",payload:u}});if(console.log("Tokenize response:",m),!m.success)throw new Error(m.message||"Failed to complete authorization");!function(e){const t=document.getElementById("oauth2-loading"),o=document.getElementById("oauth2-result"),r=document.getElementById("result-success");t.classList.add("d-none"),o.classList.remove("d-none"),r.classList.remove("d-none"),setTimeout(()=>{window.location.href=e},500)}(d.redirectUrl||d.referrer||"/account#connections")}catch(e){console.error("OAuth callback error:",e),function(e){const t=document.getElementById("oauth2-loading"),o=document.getElementById("oauth2-result"),r=document.getElementById("result-error"),n=document.getElementById("error-message"),s=document.getElementById("return-button");t.classList.add("d-none"),o.classList.remove("d-none"),r.classList.remove("d-none"),n.textContent=e;const a=new URLSearchParams(window.location.search).get("state");if(a)try{const e=JSON.parse(decodeURIComponent(a));e.referrer&&(s.href=e.referrer)}catch(e){}}(e.message)}var t}(),t()})},634:()=>{},938:()=>{},2480:()=>{},3005:()=>{},4050:()=>{},5043:()=>{},6600:()=>{},7664:()=>{},8466:()=>{}}]);